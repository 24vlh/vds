/************************************************************
 * VLAH DESIGN SYSTEM (VDS) - Tooltips & Popovers
 *
 *  Responsibilities:
 *    - Provide tooltip (non-interactive) and popover (interactive) micro-surfaces
 *    - Implement arrow rendering, semantic variants, and density modes (A / default / C)
 *    - Define positional system (top, bottom, left, right + corner variants)
 *    - Support visible/open states via modifiers and data-state attributes
 *    - Ensure accessible behaviour: pointer safety, focus-visible, and reduced-motion
 *
 *  System Notes:
 *    - Pure CSS; visibility controlled externally (no JS assumptions)
 *    - Fully token-driven: surfaces, borders, radii, shadows, z-index, transitions
 *    - Tooltip/popover arrows inherit background and border to keep seams clean
 *    - Designed to work with any inline trigger or anchor and with overlays/forms
 ************************************************************/

/* ---------------------------------------------------------
   1. TOOLTIP TRIGGERS
   Attach this class to ensure proper positioning context.
--------------------------------------------------------- */

.tooltip-trigger {
    position: relative;
    display: inline-flex;
    align-items: center;
}

/* ---------------------------------------------------------
   2. BASE TOOLTIP
--------------------------------------------------------- */

.tooltip {
    --tooltip-offset: var(--space-2);
    --tooltip-motion: 0.25rem;
    --tooltip-max-width: 24rem;
    --tooltip-arrow-size: var(--space-3);
    --tooltip-arrow-inset: var(--space-4);
    --tooltip-bg: var(--color-surface);
    --tooltip-border: var(--color-border-subtle);
    --tooltip-text: var(--color-text);

    position: absolute;
    z-index: var(--z-tooltip);

    max-width: 24rem;

    max-width: var(--tooltip-max-width);
    padding: var(--space-2) var(--space-3);

    background-color: var(--tooltip-bg);
    color: var(--tooltip-text);
    border-radius: var(--radius-sm);
    border: 1px solid var(--tooltip-border);
    box-shadow: var(--shadow-2);

    font-size: var(--text-xs);
    line-height: 1.4;
    white-space: normal;

    opacity: 0;
    pointer-events: none;

    transition: opacity var(--transition-fast) var(--ease-out), transform var(--transition-fast) var(--ease-out);
}

.tooltip--visible,
.tooltip[data-state="open"] {
    opacity: 1;
    --tooltip-motion: 0rem;
}

/* ---------------------------------------------------------
   3. TOOLTIP POSITIONS
--------------------------------------------------------- */

.tooltip--top {
    bottom: 100%;
    left: 50%;
    transform: translate(-50%, calc(-1 * var(--tooltip-offset) - var(--tooltip-motion)));
}

.tooltip--bottom {
    top: 100%;
    left: 50%;
    transform: translate(-50%, calc(var(--tooltip-offset) + var(--tooltip-motion)));
}

.tooltip--left {
    right: 100%;
    top: 50%;
    transform: translate(calc(-1 * var(--tooltip-offset) - var(--tooltip-motion)), -50%);
}

.tooltip--right {
    left: 100%;
    top: 50%;
    transform: translate(calc(var(--tooltip-offset) + var(--tooltip-motion)), -50%);
}

.tooltip--top-left {
    bottom: 100%;
    left: 0;
    transform: translate(0, calc(-1 * var(--tooltip-offset) - var(--tooltip-motion)));
}

.tooltip--top-right {
    bottom: 100%;
    right: 0;
    transform: translate(0, calc(-1 * var(--tooltip-offset) - var(--tooltip-motion)));
}

.tooltip--bottom-left {
    top: 100%;
    left: 0;
    transform: translate(0, calc(var(--tooltip-offset) + var(--tooltip-motion)));
}

.tooltip--bottom-right {
    top: 100%;
    right: 0;
    transform: translate(0, calc(var(--tooltip-offset) + var(--tooltip-motion)));
}

/* ---------------------------------------------------------
   4. TOOLTIP ARROW
--------------------------------------------------------- */

.tooltip__arrow {
    position: absolute;
    width: var(--tooltip-arrow-size);
    height: var(--tooltip-arrow-size);

    background-color: inherit;
    border: inherit;
    border-left: none;
    border-top: none;

    transform: rotate(45deg);
}

.tooltip--top .tooltip__arrow {
    top: 100%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(45deg);
}

.tooltip--top-left .tooltip__arrow {
    top: 100%;
    left: var(--tooltip-arrow-inset);
    transform: translate(0, -50%) rotate(45deg);
}

.tooltip--top-right .tooltip__arrow {
    top: 100%;
    right: var(--tooltip-arrow-inset);
    transform: translate(0, -50%) rotate(45deg);
}

.tooltip--bottom .tooltip__arrow {
    bottom: 100%;
    left: 50%;
    transform: translate(-50%, 50%) rotate(45deg);
}

.tooltip--bottom-left .tooltip__arrow {
    bottom: 100%;
    left: var(--tooltip-arrow-inset);
    transform: translate(0, 50%) rotate(45deg);
}

.tooltip--bottom-right .tooltip__arrow {
    bottom: 100%;
    right: var(--tooltip-arrow-inset);
    transform: translate(0, 50%) rotate(45deg);
}

.tooltip--left .tooltip__arrow {
    left: 100%;
    top: 50%;
    transform: translate(50%, -50%) rotate(45deg);
}

.tooltip--right .tooltip__arrow {
    right: 100%;
    top: 50%;
    transform: translate(-50%, -50%) rotate(45deg);
}

.tooltip--no-arrow .tooltip__arrow {
    display: none;
}

.tooltip--interactive.tooltip--visible,
.tooltip--interactive[data-state="open"] {
    pointer-events: auto;
}

/* ---------------------------------------------------------
   5. TOOLTIP DENSITY
--------------------------------------------------------- */

.tooltip--a {
    padding: var(--space-3) var(--space-4);
    font-size: var(--text-sm);
}

.tooltip--c {
    padding: var(--space-1) var(--space-2);
    font-size: var(--text-xs);
}

/* ---------------------------------------------------------
   6. TOOLTIP SEMANTIC VARIANTS
--------------------------------------------------------- */

.tooltip--info {
    background-color: var(--semantic-info-bg);
    color: var(--semantic-info-text);
    border-color: var(--semantic-info-border);
}

.tooltip--success {
    background-color: var(--semantic-success-bg);
    color: var(--semantic-success-text);
    border-color: var(--semantic-success-border);
}

.tooltip--warning {
    background-color: var(--semantic-warning-bg);
    color: var(--semantic-warning-text);
    border-color: var(--semantic-warning-border);
}

.tooltip--danger {
    background-color: var(--semantic-danger-bg);
    color: var(--semantic-danger-text);
    border-color: var(--semantic-danger-border);
}

/* ---------------------------------------------------------
   7. POPOVER ANCHOR
--------------------------------------------------------- */

.popover-anchor {
    position: relative;
    display: inline-block;
}

/* ---------------------------------------------------------
   8. BASE POPOVER
--------------------------------------------------------- */

.popover {
    --popover-offset: var(--space-2);
    --popover-motion: 0.25rem;
    --popover-min-width: 12rem;
    --popover-max-width: 28rem;
    --popover-arrow-size: var(--space-3);
    --popover-arrow-inset: var(--space-6);
    --popover-bg: var(--color-surface);
    --popover-border: var(--color-border-subtle);
    --popover-text: var(--color-text);

    position: absolute;
    z-index: var(--z-tooltip);

    min-width: 12rem;

    min-width: var(--popover-min-width);
    max-width: 28rem;
    max-width: var(--popover-max-width);

    background-color: var(--popover-bg);
    color: var(--popover-text);
    border-radius: var(--radius-md);
    border: 1px solid var(--popover-border);
    box-shadow: var(--shadow-3);

    display: flex;
    flex-direction: column;

    opacity: 0;
    pointer-events: none;

    transition: opacity var(--transition-fast) var(--ease-out), transform var(--transition-fast) var(--ease-out);
}

.popover--open,
.popover[data-state="open"] {
    opacity: 1;
    pointer-events: auto;
    --popover-motion: 0rem;
}

/* ---------------------------------------------------------
   9. POPOVER POSITIONS
--------------------------------------------------------- */

.popover--top {
    bottom: 100%;
    left: 50%;
    transform: translate(-50%, calc(-1 * var(--popover-offset) - var(--popover-motion)));
}

.popover--bottom {
    top: 100%;
    left: 50%;
    transform: translate(-50%, calc(var(--popover-offset) + var(--popover-motion)));
}

.popover--left {
    right: 100%;
    top: 50%;
    transform: translate(calc(-1 * var(--popover-offset) - var(--popover-motion)), -50%);
}

.popover--right {
    left: 100%;
    top: 50%;
    transform: translate(calc(var(--popover-offset) + var(--popover-motion)), -50%);
}

.popover--bottom-right {
    top: 100%;
    right: 0;
    transform: translate(0, calc(var(--popover-offset) + var(--popover-motion)));
}

.popover--bottom-left {
    top: 100%;
    left: 0;
    transform: translate(0, calc(var(--popover-offset) + var(--popover-motion)));
}

.popover--top-right {
    bottom: 100%;
    right: 0;
    transform: translate(0, calc(-1 * var(--popover-offset) - var(--popover-motion)));
}

.popover--top-left {
    bottom: 100%;
    left: 0;
    transform: translate(0, calc(-1 * var(--popover-offset) - var(--popover-motion)));
}

/* ---------------------------------------------------------
   10. POPOVER ARROW
--------------------------------------------------------- */

.popover__arrow {
    position: absolute;
    width: var(--popover-arrow-size);
    height: var(--popover-arrow-size);

    background-color: inherit;
    border: inherit;
    border-left: none;
    border-top: none;

    transform: rotate(45deg);
}

.popover--bottom .popover__arrow {
    bottom: 100%;
    left: 50%;
    transform: translate(-50%, 50%) rotate(45deg);
}

.popover--bottom-left .popover__arrow {
    bottom: 100%;
    left: var(--popover-arrow-inset);
    transform: translate(0, 50%) rotate(45deg);
}

.popover--bottom-right .popover__arrow {
    bottom: 100%;
    right: var(--popover-arrow-inset);
    transform: translate(0, 50%) rotate(45deg);
}

.popover--top .popover__arrow {
    top: 100%;
    left: 50%;
    transform: translate(-50%, -50%) rotate(45deg);
}

.popover--top-left .popover__arrow {
    top: 100%;
    left: var(--popover-arrow-inset);
    transform: translate(0, -50%) rotate(45deg);
}

.popover--top-right .popover__arrow {
    top: 100%;
    right: var(--popover-arrow-inset);
    transform: translate(0, -50%) rotate(45deg);
}

.popover--left .popover__arrow {
    left: 100%;
    top: 50%;
    transform: translate(50%, -50%) rotate(45deg);
}

.popover--right .popover__arrow {
    right: 100%;
    top: 50%;
    transform: translate(-50%, -50%) rotate(45deg);
}

.popover--no-arrow .popover__arrow {
    display: none;
}

/* ---------------------------------------------------------
   11. POPOVER LAYOUT
--------------------------------------------------------- */

.popover__header,
.popover__footer {
    padding: var(--space-3) var(--space-4);
    border-bottom: 1px solid var(--color-border-subtle);
}

.popover__footer {
    border-top: 1px solid var(--color-border-subtle);
    border-bottom: none;
    display: flex;
    justify-content: flex-end;
    gap: var(--space-2);
}

.popover__body {
    padding: var(--space-3) var(--space-4);
}

.popover__title {
    font-size: var(--text-sm);
    font-weight: 600;
}

/* ---------------------------------------------------------
   12. POPOVER DENSITY
--------------------------------------------------------- */

.popover--a .popover__header,
.popover--a .popover__footer,
.popover--a .popover__body {
    padding: var(--space-4) var(--space-5);
    font-size: var(--text-sm);
}

.popover--c .popover__header,
.popover--c .popover__footer,
.popover--c .popover__body {
    padding: var(--space-2) var(--space-3);
    font-size: var(--text-xs);
}

/* ---------------------------------------------------------
   13. POPOVER SEMANTICS
   (Aligns with overlay-inline semantics)
--------------------------------------------------------- */

.popover--info {
    background-color: var(--semantic-info-bg);
    color: var(--semantic-info-text);
    border-color: var(--semantic-info-border);
}

.popover--success {
    background-color: var(--semantic-success-bg);
    color: var(--semantic-success-text);
    border-color: var(--semantic-success-border);
}

.popover--warning {
    background-color: var(--semantic-warning-bg);
    color: var(--semantic-warning-text);
    border-color: var(--semantic-warning-border);
}

.popover--danger {
    background-color: var(--semantic-danger-bg);
    color: var(--semantic-danger-text);
    border-color: var(--semantic-danger-border);
}
